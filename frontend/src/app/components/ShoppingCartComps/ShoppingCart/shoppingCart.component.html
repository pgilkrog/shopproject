<section
  *ngIf="!cart || cart.cartItems.length <= 0"
  class="py-2">
  <div class="cart-wrap">
    <h2>No products in cart!</h2>
    <i class="fas fa-shopping-basket"></i>
    <p>We can cover all your gaming needs!</p>
  </div>
</section>

<section
  *ngIf="cart.cartItems.length > 0"
  class="py-2">
  <div class="cart-wrap p-2" *ngIf="orderProcessNumber === 1">
    <h2>Shopping Cart!</h2>
    <table class="mt-2">
      <tr *ngFor="let cartItem of cart.cartItems">
        <td routerLink="/ItemDetail/{{cartItem.item._id}}" style="cursor: pointer">
          <img src="{{cartItem.item.image}}" width="100" />
        </td>
        <td routerLink="/ItemDetail/{{cartItem.item._id}}" style="cursor: pointer">
          <p>{{ cartItem.item.name }}</p>
        </td>
        <td>
          <strong>
            <p *ngIf="cartItem.item.onSale"><span>{{ prettyCurrency(cartItem.item.price) }}</span> - {{ prettyCurrency(cartItem.item.price - cartItem.item.saleAmount) }}</p>
            <p *ngIf="!cartItem.item.onSale">{{ prettyCurrency(cartItem.item.price) }}</p>
          </strong>
        </td>
        <td>
          <div class="amount-wrap">
            <button (click)="decreaseAmount(cartItem)">-</button>
            <input value="{{cartItem.num}}" type="text" readonly disabled />
            <button (click)="addAmount(cartItem)" *ngIf="cartItem.item.amountInStock > cartItem.num">+</button>
            <button disabled *ngIf="cartItem.item.amountInStock <= cartItem.num" style="cursor: not-allowed;">+</button>
          </div>
        </td>
        <td>
          <i class="fas fa-trash-alt" (click)="removeItem(cartItem)"></i>
        </td>
        <td>
          <p *ngIf="cartItem.item.onSale">{{ 'general.total_price' | translate }}: <strong>{{ prettyCurrency(cartItem.num * (cartItem.item.price - cartItem.item.saleAmount)) }}</strong></p>
          <p *ngIf="!cartItem.item.onSale">{{ 'general.total_price' | translate }}: <strong>{{ prettyCurrency(cartItem.num * cartItem.item.price) }}</strong></p>
        </td>
      </tr>
    </table>
      <br>
    <div>
      <h3>Number of Items: {{cart.itemsAmount}} - {{ 'general.total_price' | translate }}: {{cart.totalPrice}} kr.</h3>
    </div>
    <div class="buttons pt-2">
      <button (click)="orderProcess(2)">To Delivery</button>
    </div>
  </div>

  <div class="order-info pt-3" *ngIf="orderProcessNumber === 2">
    <h2>Delivery Information</h2>
    <form [formGroup]="infoForm">
      <input formControlName="userEmail" type="input" placeholder="email" /> <br>
      <input formControlName="address" type="input" placeholder="address" /> <br>
      <input formControlName="city" type="input" placeholder="city" /> <br><br>
    </form>
    <div class="buttons">
      <button (click)="orderProcess(1)">Back to Cart</button>
      <button (click)="checkDeliveryInfo()" *ngIf="this.infoForm.valid">To Payment</button>
      <button style="background-color: grey; cursor: default;" *ngIf="!this.infoForm.valid">To Payment</button>
    </div>
  </div>

  <div class="payment-wrap" *ngIf="orderProcessNumber === 3">
    <h2>Choose Payment</h2>
    <div class="icons py-2" *ngIf="!paymentSuccessful">
      <div (click)="changeShowPayment(1)"><i class="fab fa-cc-paypal"></i><br> Paypal</div>
      <div (click)="changeShowPayment(2)"><i class="fab fa-cc-visa"></i><br> Visa</div>
      <div (click)="changeShowPayment(3)"><i class="fas fa-mobile"></i><br> MobilePay</div>
      <div (click)="changeShowPayment(4)"><i class="fas fa-gift"></i><br> Use Giftcard</div>
    </div>
    <div *ngIf="paymentSuccessful">
      <h2><i class="fas fa-check"></i><br>Success</h2>
    </div>
    <div class="buttons">
      <button (click)="orderProcess(2)">Back to delivery</button>
      <button (click)="orderProcess(4)" *ngIf="paymentSuccessful">To Overview</button>
      <button style="background-color: grey; cursor: default;" *ngIf="!paymentSuccessful">To Overview</button>
    </div>
    <app-payment
      *ngIf="showPaymentModal"
      [paymentMethodNumb]="paymentMethodNumber"
      (paymentSuccessful)="paymentSuccess()"
      (eventName)="changeShowPayment(0)"
    ></app-payment>
  </div>

  <div *ngIf="orderProcessNumber === 4">
    <h2>Overview</h2>
    <table>
      <tr *ngFor="let cartItem of cart.cartItems">
        <td>
          <img src="{{cartItem.item.image}}" width="100" />
        </td>
        <td>
          <p>{{ cartItem.item.name }}</p>
        </td>
        <td>
          <strong>
            <p *ngIf="cartItem.item.onSale"><span>{{ prettyCurrency(cartItem.item.price) }}</span> - {{ prettyCurrency(cartItem.item.price - cartItem.item.saleAmount) }}</p>
            <p *ngIf="!cartItem.item.onSale">{{ prettyCurrency(cartItem.item.price) }}</p>
          </strong>
        </td>
        <td>
          {{cartItem.num}}
        </td>
        <td>
          <p *ngIf="cartItem.item.onSale">{{ 'general.total_price' | translate }}: <strong>{{ prettyCurrency(cartItem.num * (cartItem.item.price - cartItem.item.saleAmount)) }}</strong></p>
          <p *ngIf="!cartItem.item.onSale">{{ 'general.total_price' | translate }}: <strong>{{ prettyCurrency(cartItem.num * cartItem.item.price) }}</strong></p>
        </td>
      </tr>
    </table>
    <div>
      <h3>Will be delivered to</h3>
      <p>
        {{this.infoForm.value.address}} <br>
        {{this.infoForm.value.city}}
      </p>
    </div>
    <div class="buttons">
      <button (click)="orderProcess(3)">Back to payment</button>
      <button class="checkBtn" (click)="completeOrder()">Complete your Order!</button>
    </div>
    <br>
  </div>

</section>
